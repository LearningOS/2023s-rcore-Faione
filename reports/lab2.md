# lab4

## 重写 sys_get_time 和 sys_task_info

引入虚拟地址空间后，用户程序在进行系统调用时，传入的是自己地址空间中的变量的虚拟地址，而在内核地址空间中，这一虚拟i地址无法找到真正的变量。

思路: 在内核中增加一个方法，能够将用户传递的变量指针的虚拟地址转化为物理地址，并直接修改该物理地址所对应变量以实现修改的效果
- 获取当前用户的token, 变量的虚拟地址
- 利用token获取page table
- 遍历page table找到对应的页表项，进而找到实际的物理页，与虚拟地址中的页偏移相加得到变量的物理地址
- 将物理地址进行裸指针转化为变量进行操作


## mmap 和 munmap 匿名映射

系统中的内存是分级进行管理，因此实现匿名映射也存在一个层级，自顶向下分别为

- syscall: 检查参数，转化原始数据
- task manager: 作为memory set的管理入口
- memory set: 从起始虚拟地址、结束虚拟地址、权限构造一个memory area, 并构造memory entry以进行插入
- memory area: 封装了物理页的请求，管理等，用于创建/管理物理页